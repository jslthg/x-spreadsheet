<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title><%= htmlWebpackPlugin.options.title %></title>
  <style>
    html,body{
      padding: 0;
      margin: 0;
      height: 100%;
    }
    .container{
      display: flex;flex-direction: row;height: 100%
    }
    .left{
      width: 200px;
      padding-top: 50px;
      padding-left: 20px;
    }
    .right{
      width: calc(100% - 200px);
    }
  </style>
</head>
<body onload="load()">
<!--  <div style="position: fixed; right: 0; top: .3em;">-->
<!--  <iframe src="https://ghbtns.com/github-btn.html?user=myliang&repo=x-spreadsheet&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>-->
<!--  </div>-->
  <div class="container">
<!--    <div class="left" >-->
<!--      <div id="drag" draggable="true">拖拽我</div>-->
<!--    </div>-->
    <div id="x-spreadsheet-demo" class="right" ></div>
  </div>
  <script>
    // function dragover_handler(ev) {
    //   ev.preventDefault();
    //   ev.dataTransfer.dropEffect = "copy";
    // }
    // function drop_handler(ev) {
    //   ev.preventDefault();
    //   // Get the id of the target and add the moved element to the target's DOM
    //   var data = ev.dataTransfer.getData("text/plain");
    //   // ev.target.appendChild(document.getElementById(data));
    // }

    // function dragstart_handler(ev) {
    //   // Add the target element's id to the data transfer object
    //   ev.dataTransfer.dropEffect = "copy";
    //   ev.dataTransfer.setData("application/data-report", ev.target.innerText);
    // }
    // window.addEventListener("DOMContentLoaded", () => {
    //   // Get the element by id
    //   const element = document.getElementById("drag");
    //   // Add the ondragstart event listener
    //   element.addEventListener("dragstart", dragstart_handler);
    // });

    function load(){
      const rows10 = { len: 1000 };
      for (let i = 0; i < 1000; i += 1) {
        rows10[i] = {
          cells: {
            0: { text: 'A-' + i },
            1: { text: 'B-' + i },
            2: { text: 'C-' + i },
            3: { text: 'D-' + i },
            4: { text: 'E-' + i },
            5: { text: 'F-' + i },
          }
        };
      }
      const rows = {
        len: 80,
        1: {
          cells: {
            0: { text: 'sxj' },
            2: { text: 'testing' },
          },
        },
        2: {
          cells: {
            0: { text: 'render', style: 0 },
            1: { text: 'Hello' },
            2: { text: 'haha', merge: [1, 1] },
          }
        },
        8: {
          cells: {
            8: { text: 'border test', style: 0 },
          }
        }
      };
      var saveIcon = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTc3MTc3MDkyOTg4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjI2NzgiIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTIxMy4zMzMzMzMgMTI4aDU5Ny4zMzMzMzRhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMSA4NS4zMzMzMzMgODUuMzMzMzMzdjU5Ny4zMzMzMzRhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMS04NS4zMzMzMzMgODUuMzMzMzMzSDIxMy4zMzMzMzNhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMS04NS4zMzMzMzMtODUuMzMzMzMzVjIxMy4zMzMzMzNhODUuMzMzMzMzIDg1LjMzMzMzMyAwIDAgMSA4NS4zMzMzMzMtODUuMzMzMzMzeiBtMzY2LjkzMzMzNCAxMjhoMzQuMTMzMzMzYTI1LjYgMjUuNiAwIDAgMSAyNS42IDI1LjZ2MTE5LjQ2NjY2N2EyNS42IDI1LjYgMCAwIDEtMjUuNiAyNS42aC0zNC4xMzMzMzNhMjUuNiAyNS42IDAgMCAxLTI1LjYtMjUuNlYyODEuNmEyNS42IDI1LjYgMCAwIDEgMjUuNi0yNS42ek0yMTMuMzMzMzMzIDIxMy4zMzMzMzN2NTk3LjMzMzMzNGg1OTcuMzMzMzM0VjIxMy4zMzMzMzNIMjEzLjMzMzMzM3ogbTEyOCAwdjI1NmgzNDEuMzMzMzM0VjIxMy4zMzMzMzNoODUuMzMzMzMzdjI5OC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS00Mi42NjY2NjcgNDIuNjY2NjY3SDI5OC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMS00Mi42NjY2NjctNDIuNjY2NjY3VjIxMy4zMzMzMzNoODUuMzMzMzMzek0yNTYgMjEzLjMzMzMzM2g4NS4zMzMzMzMtODUuMzMzMzMzeiBtNDI2LjY2NjY2NyAwaDg1LjMzMzMzMy04NS4zMzMzMzN6IG0wIDU5Ny4zMzMzMzR2LTEyOEgzNDEuMzMzMzMzdjEyOEgyNTZ2LTE3MC42NjY2NjdhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSA0Mi42NjY2NjctNDIuNjY2NjY3aDQyNi42NjY2NjZhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSA0Mi42NjY2NjcgNDIuNjY2NjY3djE3MC42NjY2NjdoLTg1LjMzMzMzM3ogbTg1LjMzMzMzMyAwaC04NS4zMzMzMzMgODUuMzMzMzMzek0zNDEuMzMzMzMzIDgxMC42NjY2NjdIMjU2aDg1LjMzMzMzM3oiIHAtaWQ9IjI2NzkiIGZpbGw9IiMyYzJjMmMiPjwvcGF0aD48L3N2Zz4='
      var previewEl = document.createElement('img')
      previewEl.src = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxMzI4NTkxMjQzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjU2NjMiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEyIDE4Ny45MDRhNDM1LjM5MiA0MzUuMzkyIDAgMCAwLTQxOC41NiAzMTUuNjQ4IDQzNS4zMjggNDM1LjMyOCAwIDAgMCA4MzcuMTIgMEE0MzUuNDU2IDQzNS40NTYgMCAwIDAgNTEyIDE4Ny45MDR6TTUxMiAzMjBhMTkyIDE5MiAwIDEgMSAwIDM4NCAxOTIgMTkyIDAgMCAxIDAtMzg0eiBtMCA3Ni44YTExNS4yIDExNS4yIDAgMSAwIDAgMjMwLjQgMTE1LjIgMTE1LjIgMCAwIDAgMC0yMzAuNHpNMTQuMDggNTAzLjQ4OEwxOC41NiA0ODUuNzZsNC44NjQtMTYuMzg0IDQuOTI4LTE0Ljg0OCA4LjA2NC0yMS41NjggNC4wMzItOS43OTIgNC43MzYtMTAuODggOS4zNDQtMTkuNDU2IDEwLjc1Mi0yMC4wOTYgMTIuNjA4LTIxLjMxMkE1MTEuNjE2IDUxMS42MTYgMCAwIDEgNTEyIDExMS4xMDRhNTExLjQ4OCA1MTEuNDg4IDAgMCAxIDQyNC41MTIgMjI1LjY2NGwxMC4yNCAxNS42OGMxMS45MDQgMTkuMiAyMi41OTIgMzkuMTA0IDMyIDU5Ljc3NmwxMC40OTYgMjQuOTYgNC44NjQgMTMuMTg0IDYuNCAxOC45NDQgNC40MTYgMTQuODQ4IDQuOTkyIDE5LjM5Mi0zLjIgMTIuODY0LTMuNTg0IDEyLjgtNi40IDIwLjA5Ni00LjQ4IDEyLjYwOC00Ljk5MiAxMi45MjhhNTExLjM2IDUxMS4zNiAwIDAgMS0xNy4yOCAzOC40bC0xMi4wMzIgMjIuNC0xMS45NjggMjAuMDk2QTUxMS41NTIgNTExLjU1MiAwIDAgMSA1MTIgODk2YTUxMS40ODggNTExLjQ4OCAwIDAgMS00MjQuNDQ4LTIyNS42bC0xMS4zMjgtMTcuNTM2YTUxMS4yMzIgNTExLjIzMiAwIDAgMS0xOS44NC0zNS4wMDhMNTMuMzc2IDYxMS44NGwtOC42NC0xOC4yNC0xMC4xMTItMjQuMTI4LTcuMTY4LTE5LjY0OC04LjMyLTI2LjYyNC0yLjYyNC05Ljc5Mi0yLjQ5Ni05LjkyeiIgcC1pZD0iNTY2NCI+PC9wYXRoPjwvc3ZnPg=='
      previewEl.width = 16
      previewEl.height = 16

      var xs = x_spreadsheet('#x-spreadsheet-demo', {
        mode:'view',
        showToolbar: true,
        showGrid: true,
        showBottomBar: false,
        extendToolbar: {
          // left: [
          //   {
          //     tip: '保存',
          //     icon: saveIcon,
          //     onClick: (data, sheet) => {
          //       console.log('click save button：', data, sheet)
          //     }
          //   },
          // ],
          // right: [
          //   {
          //     tip: 'Preview',
          //     el: previewEl,
          //     onClick: (data, sheet) => {
          //       console.log('click preview button：', data)
          //     }
          //   }
          // ],
        }
      })
        .loadData([{"name":"sheet1","freeze":"A1","styles":[{"font":{"name":"隶书"}},{"font":{"name":"隶书","size":16}},{"font":{"name":"隶书","size":16},"textwrap":true}],"images":{"len":1,"6c0c9489-1699-1603-b291-578a1c84ef12":{"id":"6c0c9489-1699-1603-b291-578a1c84ef12","src":"http://127.0.0.3/photo/image/1699052782250.jpg","left":100,"top":200,"width":367,"height":192,"cellRange":{"sc":{"ri":7,"ci":0},"ec":{"ri":14,"ci":4}}}},"charts":{"len":0},"merges":["B5:G5","B6:G6"],"rows":{"4":{"cells":{"1":{"text":"d法国电视了；科技手段拉开放假了凯撒地方离开家拉萨的弗兰克骄傲了史蒂夫","merge":[0,5]}}},"5":{"cells":{"1":{"merge":[0,5],"text":"绿卡技术的离开房间洒到了记录卡上的法律框架卢卡斯地方了看见啦SD卡","style":2},"2":{"style":2},"3":{"style":2},"4":{"style":2},"5":{"style":2},"6":{"style":2}},"height":47},"len":100},"cols":{"len":26},"validations":[],"autofilter":{}}]).change((cdata) => {
          // console.log(cdata);
          console.log('>>>', xs.getData());
        });
      //
// console.log(3333333333,xs)
//       xs.on('cell-selected', (cell, ri, ci) => {
//           console.log('cell-selected:', cell, ', ri:', ri, ', ci:', ci);
//         }).on('cell-edited', (text, ri, ci) => {
//           console.log('text-edited:', text, ', ri: ', ri, ', ci:', ci);
//         }).on('pasted-clipboard', (data) => {
//           console.log('>>>> data is  pasted-clipboard ', data);
//         }).on('saved', function(){
//         console.log('click save button：')
//       }).on('toolbar-change', function(t,v){
//       console.log('click save button：',t,v)
//     });
      //
      // setTimeout(() => {
      //   // xs.loadData([{ rows }]);
      //   xs.cellText(6, 3, 'cell-text').reRender();
      //   console.log('cell(8, 8):', xs.cell(8, 8));
      //   console.log('cellStyle(8, 8):', xs.cellStyle(8, 8));
      // }, 5000);
    }

  </script>


</body>
</html>
